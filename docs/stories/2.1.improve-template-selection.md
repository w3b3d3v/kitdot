# Story 2.1: Improve Template Selection UX

## Status

Done

## Story

**As a** developer using the CLI tool,
**I want** to see the default template as an option when selecting frontend-only, or backend-only
**so that** I have a consistent experience and can easily choose the local default template without being forced into a remote template workflow.

## Acceptance Criteria

1. When user selects "Frontend only", they should see available frontend templates including the default template as an option
2. When user selects "Backend only" or "Smart Contracts only", they should see available backend/contract templates including the default contracts template as an option
3. If no template options are available for a selection, automatically initialize with the appropriate default (contracts or frontend) without showing a selection menu
4. The default template should be clearly labeled and easily identifiable in template selection lists
5. Template selection behavior should be consistent across all project types (frontend, backend, fullstack)

## Tasks / Subtasks

- [x] Update template registry to include default template in appropriate categories (AC: 1, 2)
  - [x] Add default frontend template entry to registry
  - [x] Add default contracts template entry to registry
  - [x] Update getTemplatesByCategory to include default options
- [x] Modify template selection logic in init.ts (AC: 1, 2, 3)
  - [x] Update frontend-only flow to include default template option
  - [x] Update backend-only flow to include default contracts template option
  - [x] Add fallback logic for when no templates are available
- [x] Improve template labeling and presentation (AC: 4, 5)
  - [x] Add clear labeling for default templates in selection menus
  - [x] Ensure consistent template selection UX across project types
- [x] Add comprehensive tests for new template selection flows (AC: 1, 2, 3, 4, 5)
  - [x] Test frontend-only selection with default option
  - [x] Test backend-only selection with default option
  - [x] Test automatic fallback when no templates available
  - [x] Test template labeling and presentation

## Dev Notes

### Relevant Source Tree Info

- `src/commands/init.ts`: Contains main project initialization logic and template selection flow (lines 115-157)
- `src/templates/registry.ts`: Defines TEMPLATE_REGISTRY with available templates and getTemplatesByCategory function
- `src/types.ts`: Contains type definitions for ProjectConfig, TemplateConfig, and related interfaces
- Current registry has "default" as fullstack category, need to create separate frontend/backend entries

### Current Template Selection Logic Analysis

The current implementation in `init.ts:115-157` shows:

1. Frontend-only: Gets only frontend templates (line 121)
2. Fullstack: Gets frontend + fullstack templates (line 125)
3. Backend: No specific template selection logic currently
4. Default template is only available when user explicitly chooses "Install default template" upfront
5. Template selection only shows if `availableTemplates.length > 1` (line 133)

### Required Changes

1. Registry needs separate entries for default frontend and default contracts
2. Template selection logic needs to include default options in appropriate categories
3. Backend template selection flow needs to be implemented
4. Fallback logic needed when no templates available (auto-select default)

### Testing Standards

Testing requirements from architecture:

- Test file location: `test/` directory following existing patterns like `test-cli.js`
- Testing frameworks: Jest for unit tests, comprehensive CLI testing
- Test the complete user flow including template selection prompts and project creation
- Verify template registry filtering works correctly for all categories
- Test edge cases like no available templates and single template scenarios

## Change Log

| Date       | Version | Description            | Author   |
| ---------- | ------- | ---------------------- | -------- |
| 2025-09-20 | 1.0     | Initial story creation | SE Agent |

## Dev Agent Record

### Agent Model Used

Claude Sonnet 4 (claude-sonnet-4-20250514)

### Debug Log References

_To be populated during development_

### Completion Notes List

- Successfully added default-frontend and default-contracts template entries to registry
- Updated template selection logic to include backend project type handling
- Implemented fallback logic for when no templates are available in a category
- Added clear labeling for default templates "(Default)" suffix
- Created comprehensive test suites covering all template selection scenarios
- All acceptance criteria validated through automated tests

### File List

**Modified Files:**

- `src/templates/registry.ts` - Added default-frontend and default-contracts template entries
- `src/commands/init.ts` - Updated template selection logic with backend support and fallback handling

**New Files:**

- `test/template-selection.test.js` - Unit tests for template registry and selection logic
- `test/template-selection-integration.test.js` - Integration tests for template selection workflows

## QA Results

_To be populated by QA Agent after implementation review_
