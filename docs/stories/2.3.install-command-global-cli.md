# Story 2.3: Install Command and Global CLI Access

## Status

Done

## Story

**As a** developer setting up kitdot on a new machine,
**I want** to run `npx kitdot install` as a wrapper for the init command and have global CLI access,
**so that** I can use the familiar "install" terminology while leveraging existing project initialization.

## Context

**Change Type**: Feature Enhancement
**Scope**: CLI system enhancement with installation command and global accessibility
**Impact**: CLI command system, package configuration, developer workflow
**Prompt Source**: "on new machines/projects: 'npx kitdot install' initializes the sdk. Also, make the user don't need to run npx kitdot just kitdot on cli after installing."

## Acceptance Criteria

1. **Install Command Functionality**

   - `npx kitdot install` command acts as a wrapper for the existing init command
   - Install command delegates to init functionality for project creation
   - Install command maintains the same interface and behavior as init

2. **Global CLI Access**

   - After installation, users can run `kitdot` directly without `npx` prefix
   - Global installation preserves all existing CLI functionality
   - Package configuration supports both local and global usage patterns

3. **Quality Requirements**
   - Installation process is idempotent (safe to run multiple times)
   - Clear error handling for installation failures
   - Help documentation updated to reflect new installation workflow
   - Existing CLI functionality remains unchanged

## Dev Notes

### Implementation Approach

- Add new `install` command to CLI system that wraps the existing init command
- Configure package.json with proper `bin` field for global CLI access (already exists)
- Install command should delegate all functionality to the existing init command
- Update CLI help system to document new installation workflow

### Key Considerations

- Installation should be safe and idempotent
- Global CLI access requires proper bin configuration in package.json
- Consider what "SDK initialization" means in the context of kitdot (dependencies, tools, configuration)
- Maintain backward compatibility with existing npx usage
- Installation should work across different operating systems

### Files Likely Affected

- `src/cli.ts` - Add install command definition
- `src/commands/install.ts` - New install command implementation
- `package.json` - Add bin field for global CLI access
- Help documentation and command descriptions

### Testing Strategy

- Unit tests for install command logic
- Integration tests for global CLI installation
- Test installation on clean environment
- Verify existing functionality not broken
- Test both local (npx) and global usage patterns

## Tasks / Subtasks

- [x] Task 1: Create install command wrapper (AC: 1)

  - [x] Add install command definition to CLI
  - [x] Create simple wrapper that delegates to init command
  - [x] Ensure install command accepts same arguments as init
  - [x] Update CLI help to include install command

- [x] Task 2: Verify global CLI access (AC: 2)

  - [x] Confirm package.json bin field is properly configured
  - [x] Test global installation process (npm link)
  - [x] Verify all existing commands work globally
  - [x] Document global installation process

- [x] Task 3: Testing and validation (AC: 1, 2, 3)
  - [x] Test install command delegates properly to init
  - [x] Test global vs local CLI usage patterns
  - [x] Verify install command maintains init functionality
  - [x] Update CLI help documentation and error messages

## Change Log

| Date       | Version | Description                             | Author          |
| ---------- | ------- | --------------------------------------- | --------------- |
| 2025-09-20 | 1.0     | Initial story creation from user prompt | Claude Sonnet 4 |

## Dev Agent Record

### Agent Model Used

Sonnet 4 (claude-sonnet-4-20250514)

### Debug Log References

_To be populated during implementation_

### Completion Notes List

- Successfully modified install command to act as SDK setup + project initialization wrapper
- Install command now performs SDK tool installation (Rust) first, then optionally delegates to init command
- Maintained backward compatibility with existing SDK installation functionality
- Added project name argument and directory option to install command
- Verified global CLI access works correctly through npm link testing
- All existing CLI functionality preserved and working globally
- Fixed Commander.js argument order issue (projectName first, then options)
- Added comprehensive CLI tests for install command functionality
- Resolved esbuild platform mismatch issue through dependency reinstallation

### File List

- `src/cli.ts` - Updated install command definition with project name argument and directory option
- `src/commands/install.ts` - Modified to import initCommand and delegate project creation after SDK setup
- `test/cli-improvements.test.ts` - Added comprehensive tests for install command functionality
- `package.json` - Added tsx dependency and verified bin field configuration

## QA Results

_To be populated by QA agent_
