# Story 1.3: fix-directory-structure

## Status

Done

## Story

**As a** developer using kitdot CLI,
**I want** consistent directory naming and proper handling of fullstack templates,
**so that** I don't get duplicate or incorrectly named frontend directories when using templates.

## Acceptance Criteria

1. Fullstack templates that already contain frontend should not create additional "front" directories
2. When frontend directories are created separately, they should be named "frontend" instead of "front"
3. Default template (fullstack) should not trigger creation of separate frontend folder since it contains both
4. Existing logic for frontend-only and backend-only projects should remain unchanged
5. Directory structure should be consistent across all template types

## Tasks / Subtasks

- [x] Fix directory naming from "front" to "frontend" (AC: 2)
  - [x] Update project-structure.ts to use "frontend" instead of "front"
  - [x] Update setup-frontend.ts to reference "frontend" directory
- [x] Prevent duplicate frontend folders for fullstack templates (AC: 1, 3)
  - [x] Modify logic to detect when template already contains frontend
  - [x] Skip frontend directory creation for fullstack templates
- [x] Update directory logic consistency (AC: 4, 5)
  - [x] Ensure frontend-only projects still work at root
  - [x] Ensure backend-only projects don't create frontend folders
  - [x] Test all template categories work correctly
- [x] Test directory structure fixes (AC: 1-5)
  - [x] Test default template doesn't create extra "front" folder
  - [x] Test frontend-only templates work at project root
  - [x] Test custom fullstack vs frontend template directory placement
  - [x] Verify "frontend" naming is used consistently

## Dev Notes

### Relevant Source Tree info

- Directory creation: `src/utils/project-structure.ts` - creates folder structure for projects
- Frontend setup: `src/utils/setup-frontend.ts` - determines where frontend templates go
- Template logic: `src/commands/init.ts` - coordinates template selection and setup

### Current Issue Analysis

1. **"front" vs "frontend"**: Line 25 in project-structure.ts creates "front" but should be "frontend" for consistency
2. **Duplicate folders**: Fullstack templates contain both frontend and contracts, but we also create separate folders
3. **Logic conflict**: Default template is fullstack category but still triggers frontend folder creation

### Key Implementation Points

- Default template category is "fullstack" so it should go to project root without separate folders
- Frontend-only templates should continue going to project root (no subdirectory)
- Only templates with category "frontend" in fullstack projects should get "frontend" subdirectory
- Need to prevent project-structure.ts from creating frontend folder when template handles it

### Current Directory Logic

- Frontend-only: Template at root (correct)
- Fullstack with fullstack template: Template at root (correct, but folders still created)
- Fullstack with frontend template: Template in "front" subdirectory (should be "frontend")

### Testing

#### Test file location

- Tests should be in `test/` directory following existing patterns
- Create integration tests for directory structure scenarios

#### Test standards

- Test all template category combinations
- Verify no duplicate directories are created
- Test consistent naming across scenarios

#### Testing frameworks and patterns to use

- Use existing testing framework (Jest)
- Mock file system operations for unit tests
- Create integration tests with temporary directories

#### Specific testing requirements for this story

- Test default template creates no extra folders
- Test "frontend" naming is used consistently
- Test fullstack vs frontend template directory placement
- Test no regression in existing frontend-only/backend-only behavior

## Change Log

| Date       | Version | Description            | Author   |
| ---------- | ------- | ---------------------- | -------- |
| 2025-09-20 | 1.0     | Initial story creation | se-agent |

## Dev Agent Record

### Agent Model Used

claude-sonnet-4-20250514

### Debug Log References

- test-directory-structure.js: Tests project structure creation for all scenarios
- test-template-logic.js: Tests feature determination logic for different template categories
- test-integration-directory.js: Complete integration test for directory structure fixes

### Completion Notes List

- Successfully renamed "front" to "frontend" in project-structure.ts and setup-frontend.ts
- Added determineNeedsFrontend() function to prevent duplicate frontend directories
- Fixed default template features to not create separate directories (template contains both)
- Maintained existing logic for frontend-only and backend-only projects
- All integration tests pass - no duplicate directories, consistent naming
- TypeScript compilation and ESLint checks pass successfully

### File List

- **Modified**: src/utils/project-structure.ts - Changed "front" to "frontend" directory naming
- **Modified**: src/utils/setup-frontend.ts - Updated comment and directory reference to "frontend"
- **Modified**: src/commands/init.ts - Added determineNeedsFrontend() function and updated default template features
- **Created**: test-directory-structure.js - Unit tests for directory structure creation
- **Created**: test-template-logic.js - Tests for template feature determination logic
- **Created**: test-integration-directory.js - Complete integration tests for all scenarios

## QA Results

(To be populated by QA Agent)
